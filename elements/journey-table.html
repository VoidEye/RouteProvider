<!DOCTYPE html>
<html>
<head>
	<link href="../bower_components/polymer/polymer.html" rel="import">
	<link href="../bower_components/paper-icon-button/paper-icon-button.html" rel="import">
	<link href="../bower_components/paper-material/paper-material.html" rel="import">
	<link href="../bower_components/paper-input/paper-input.html" rel="import">
	<link href="../bower_components/paper-fab/paper-fab.html" rel="import">
	<link href="../bower_components/paper-button/paper-button.html" rel="import">
	<link href="../bower_components/iron-icons/iron-icons.html" rel="import">
	<link href="../bower_components/paper-checkbox/paper-checkbox.html" rel="import">
	<link href="../bower_components/paper-item/paper-item.html" rel="import">

	<script src="//code.jquery.com/jquery-1.10.2.js"></script>
  	<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
</head>

<dom-module id="journey-table">

<style>
#stepAdder, #stepRemover{
			background-color: green;
			height: 25px;
			margin-top: 15px;
			min-width: 35px;
			padding: 0px;
}
#wholeTable {
	overflow: hidden;
	height: auto;
}
#hourPicker, #minutePicker{
			width: 25px;
}
#datePicker {
	width: 75px;
}
#DirectionsEntry {
	margin-top: 15px;
	padding-top: 50px;
	max-width: 180px;
	max-height: 200px;
}
#JourneyOptions {
	width: 135px;
	float: left;
	overflow: hidden;
}
#getToday {
	font-size: 1px;
	min-width: 25px;
	margin-left: 25px;
}
#getNowIc{
	width: 20px;
    height: 20px;
}
#swap {
	max-width: 10px;
	font-size: 10px;
	margin-top: 5px;
}
#stopsTable {
	float: left;
	width: 160px;
}
#firstColumn {
	width: 180px;
	overflow: hidden;
	float:left;
}
#expandButton{
	margin-top: 33px;
}
#stopsTable{
	width: 160px;
	float: left;
	overflow: hidden;
}
#buttons{
	float: left;
	margin-top: 9px;
	max-width: 20px;
}
#buttons img{
	margin-top: 11px;
	margin-left: 1px;
	float: left;
	cursor: pointer;
}
#maxWalk{
	width: 55px;
}
#stepAdder, #stepRemover{
	font-size: 1px;
	margin-top: 5px;
	min-width: 30px;
}
.directionsInput {
	max-width: 160px;
	margin-top: 5px;
}
paper-material{
	max-width: 315px;
	width: 100%;
	margin: 25px auto;
	position: relative;
	padding: 10px;
}
paper-checkbox{
	font-size: 14px;
}

</style>
<template>
	<paper-material id="wholeTable">
		<div id="firstColumn">
			<div id="stopsTable">
				<template id="journeyTableT" is="dom-repeat" items="{{journeyStops}}">
    				<input type="text" id="{{item}}" class="directionsInput">
    			</template>	
    		
    					<!--needs uniques ids for every table, and unique id for button -->
    		<div id="stopButtons">
    			<paper-button raised id="stepAdder" on-click="addStep"> 
    				<iron-icon id"addStepIcon" icon="add"></iron-icon>
    			</paper-button>
    			<paper-button raised id="stepRemover" on-click="removeStep"> 
    				<iron-icon id"removeStepIcon" icon="block"></iron-icon>
    			</paper-button>
    		</div>
    		</div>
    		<div id="buttons">
    			<template is="dom-repeat" items="{{swapButtons}}">
    				<img src="../images/swap.jpg" id="{{item.swapID}}" onclick="swapStartStop" class="swapButtons"/>
    			</template>
    		</div>
    		<!--<div id="expandButton"></div>-->
    	</div>
    	<div id="JourneyOptions">
    		<input type="text" id="datePicker">
			<input type="text" id="hourPicker">:<input type="text" id="minutePicker">
			<paper-checkbox>Przyjazd</paper-checkbox>
					<!--<paper-fab id="mainButton" icon="icons:reply" on-click="forwardRequest"></paper-fab>-->
				<paper-button id="getToday" on-click="setCurrentDate"><iron-icon id="getNowIc" icon="query-builder"></iron-icon></paper-button>
			Trasa piechotÄ…:
			<input type="text" id="maxWalk">
		</div>
	</paper-material>
</template>
<script>
//container max width and height
//highlight element that is curretly in focus.
	Polymer({
		is: "journey-table",
    	properties: {
    		swapButtons: {
    			type: Array,
    			value: function() { 
    				return [{swapID: "swapBtn1"}];
    			}
    		}		
    	},

		addStep: function(){
    		if(this.journeyStops.length < 4){
    			var lastItem = this.journeyStops[this.journeyStops.length - 1];
    			lastItem += 1;
    			var newBtnVal = "swapBtn" + lastItem;
    			var newValue = "inputStop" + lastItem;   			
    			this.push('journeyStops', newValue);
    			this.push('swapButtons', newBtnVal)
    		}
    		/*if(this.journeyStops.length > 2)
    		{
				document.getElementById("wholeTable").style.overflow = "hidden";
				document.getElementById("wholeTable").style.height = "auto";
    		}*/
    	},

    	removeStep: function(){
    		if(this.journeyStops.length > 2){
    			this.pop('journeyStops');
    			this.pop('swapButtons');
    		}
    	},
    	expandStopsTable: function(){
    		var expanded = false;
    		if(this.journeyStops.length	> 2 && !expanded)
    		{
    			document.getElementById("wholeTable").style.overflow = "visible";
				document.getElementById("wholeTable").style.height = "96px";
    		}
    	},

        setCurrentDate: function(){
    		setDate();
    	},

    	ready: function(e){
    		this.journeyStops = ["inputStop0","inputStop1"];
		}
  	});
  	$(function(){
    	$("#datePicker").datepicker({
    		showButtonPanel: true,
   			dateFormat: "mm/dd/yy",
    		beforeShow: function(){    
           	$(".ui-datepicker").css('font-size', 12) 
    		}
    	});
  	});
  	$('#firstColumn').click(function() {
    	var reducedHeight = $(this).height();
   		$(this).css('height', 'auto');
    	var fullHeight = $(this).height();
    	$(this).height(reducedHeight);

    	$(this).animate({height: fullHeight}, 500);
	});

  	window.addEventListener('WebComponentsReady', function(e){
  		setDate();
	})

	function setDate(){
		var today = new Date();
    	var hours = today.getHours();
    	var minutes = today.getMinutes();
		var dd = today.getDate();
		var mm = today.getMonth()+1; //January is 0!
		var yyyy = today.getFullYear();

		if(dd<10)
    		dd = '0'+ dd
		if(mm<10)
    		mm = '0' + mm
		if(minutes < 10)
			minutes = '0' + minutes;

		today = mm+'/'+dd+'/'+yyyy;
		document.getElementById('hourPicker').value = hours;
		document.getElementById('minutePicker').value = minutes;
		document.getElementById('datePicker').value = today;
	}

</script>
</dom-module>
